import pandas as pd

list1 = [108.11,
         112.53,
         6.29,
         31.37,
         82.88,
         20.79,
         129.0,
         119.98,
         139.23,
         114.84,
         49.71,
         50.94,
         110.52,
         107.42,
         133.49,
         72.67,
         27.95,
         42.81,
         7.08,
         28.26,
         139.43,
         54.26,
         103.2,
         26.56,
         55.26,
         5.91,
         110.68,
         92.43,
         125.73,
         55.11,
         124.29,
         49.32,
         8.72,
         126.8,
         30.12,
         133.27,
         18.4,
         62.85,
         27.46,
         47.67,
         6.78,
         28.16,
         85.07,
         108.05,
         69.45,
         40.77,
         57.89,
         23.41,
         94.89,
         67.43,
         47.95,
         46.92,
         136.51,
         46.61,
         128.16,
         47.74,
         41.7,
         64.6,
         62.78,
         74.57,
         42.92,
         56.84,
         53.2,
         72.81,
         14.07,
         90.27,
         21.35,
         98.16,
         43.59,
         69.98,
         8.74,
         70.14,
         129.98,
         64.99,
         68.41,
         84.97,
         129.69,
         5.81,
         123.05,
         91.08,
         91.04,
         139.09,
         115.54,
         108.48,
         113.72,
         116.06,
         123.7,
         87.46,
         18.16,
         118.9,
         108.36,
         105.76,
         16.93,
         80.33,
         38.33,
         126.11,
         11.62,
         99.33,
         104.93,
         121.59,
         116.33,
         37.5,
         19.35,
         18.25,
         87.92,
         54.85,
         75.83,
         72.2,
         121.62,
         94.93,
         57.5,
         57.62,
         13.77,
         132.72,
         127.15,
         29.69,
         26.36,
         64.55,
         87.11,
         15.07,
         32.04,
         27.33,
         19.16,
         105.58,
         87.94,
         84.98]

list2 = [127.64,
         57.39,
         69.45,
         123.19,
         64.47,
         52.28,
         50.45,
         47.39,
         146.81,
         135.48,
         41.95,
         100.99,
         66.86,
         18.81,
         75.96,
         66.1,
         46.99,
         86.81,
         109.48,
         20.91,
         141.49,
         116.95,
         142.44,
         15.8,
         23.96,
         100.57,
         36.65,
         95.15,
         138.38,
         118.85,
         90.79,
         21.77,
         136.58,
         47.48,
         143.45,
         78.91,
         38.39,
         68.37,
         95.06,
         31.54,
         23.76,
         43.63,
         47.68,
         104.94,
         141.93,
         135.42,
         109.83,
         110.87,
         88.97,
         46.51,
         66.49,
         62.35,
         103.03,
         37.18,
         90.04,
         81.15,
         67.86,
         100.04,
         78.92,
         42.27,
         141.66,
         76.38,
         101.3,
         98.58,
         12.07,
         61.16,
         58.3,
         81.87,
         109.17,
         93.36,
         87.81,
         115.44,
         61.12,
         21.82,
         137.75,
         55.7,
         90.99,
         24.09,
         57.41,
         13.33,
         121.75,
         68.25,
         107.27,
         108.83,
         94.77,
         56.46,
         62.15,
         52.54,
         31.56,
         107.91,
         39.09,
         8.73,
         66.8]

list3 = [32.85,
         14.45,
         101.58,
         9.34,
         126.74,
         60.17,
         43.69,
         128.26,
         131.83,
         145.74,
         148.86,
         145.19,
         58.47,
         132.94,
         93.71,
         62.79,
         24.01,
         55.42,
         19.86,
         44.83,
         146.31,
         68.63,
         6.65,
         54.66,
         88.85,
         77.13,
         26.7,
         149.15,
         88.47,
         20.37,
         129.35,
         13.48,
         129.72,
         136.89,
         97.2,
         55.43,
         40.88,
         97.68,
         113.9,
         58.93,
         124.43,
         5.89,
         36.85,
         23.73,
         67.16,
         70.38,
         71.63,
         14.48,
         62.49,
         60.49,
         34.87,
         148.31,
         19.43,
         8.19,
         81.4,
         56.04,
         80.79,
         39.06,
         20.06,
         57.22,
         85.21,
         28.13,
         25.73,
         34.68,
         128.34,
         128.23,
         27.57,
         17.05,
         54.35,
         25.28,
         74.41,
         58.7,
         70.27,
         24.68,
         17.28,
         16.98,
         120.05,
         42.96,
         93.32,
         91.76,
         26.99,
         26.3,
         94.42,
         129.03,
         127.36,
         30.04,
         16.75,
         108.01,
         51.2,
         60.51,
         108.5,
         17.58,
         10.94]

list4 = [102.76,
         147.73,
         20.06,
         131.29,
         97.18,
         51.69,
         124.13,
         118.51,
         66.95,
         27.02,
         101.84,
         29.37,
         77.78,
         55.74,
         109.3,
         57.09,
         69.62,
         7.93,
         82.69,
         111.96,
         36.68,
         136.63,
         36.78,
         102.9,
         18.56,
         49.96,
         38.87,
         147.86,
         115.12,
         58.12,
         44.63,
         28.6,
         143.96,
         5.73,
         12.4,
         142.27,
         121.07,
         21.64,
         45.51,
         149.95,
         54.83,
         85.92,
         143.16,
         141.89,
         120.08,
         81.51,
         86.53,
         40.27,
         7.43,
         55.88,
         12.59,
         93.23,
         34.78,
         61.61,
         81.41,
         91.29,
         75.0,
         106.8,
         37.48,
         142.28,
         58.9,
         51.69,
         39.23,
         124.74,
         21.76,
         131.27,
         100.76,
         26.16,
         143.93,
         71.53,
         27.51,
         112.07,
         25.93,
         82.82,
         35.49,
         110.48,
         69.32,
         28.21,
         109.0,
         8.37,
         120.93,
         12.39,
         103.53,
         82.26,
         135.51,
         32.65,
         137.82,
         23.2,
         63.84,
         8.7,
         75.73,
         141.86,
         57.19,
         69.24,
         139.2,
         79.41,
         35.94,
         140.37,
         143.85,
         109.1,
         130.61,
         140.53,
         110.9,
         131.52,
         149.56,
         6.84,
         110.55,
         125.72,
         127.71]

list5 = [123.53,
         9.32,
         90.69,
         48.27,
         13.81,
         53.22,
         83.33,
         61.3,
         100.42,
         75.75,
         101.39,
         138.17,
         149.02,
         44.11,
         42.94,
         59.71,
         20.65,
         57.88,
         60.09,
         135.25,
         58.91,
         132.67,
         16.54,
         18.45,
         107.29,
         116.1,
         125.91,
         53.14,
         148.17,
         97.2,
         22.16,
         85.35,
         50.93,
         116.02,
         78.87,
         19.92,
         42.67,
         130.19,
         29.82,
         23.8,
         122.91,
         7.55,
         144.53,
         72.7,
         100.27,
         138.55,
         128.51,
         79.61,
         34.93,
         42.99,
         96.66,
         77.78,
         135.99,
         16.46,
         32.37,
         18.65,
         146.46,
         143.56,
         113.54,
         129.28,
         116.11,
         140.67,
         111.02,
         106.99,
         76.97,
         78.38,
         17.27,
         30.82,
         143.46,
         133.71,
         15.97,
         32.92,
         99.41,
         147.3,
         82.52,
         68.85,
         102.38,
         59.0,
         59.65]
import featuretools as ft
pd.set_option('display.max_columns', 100)
data = ft.demo.load_mock_customer()
transactions_df = data["transactions"].merge(
    data["sessions"]).merge(data["customers"]).merge(data["products"])
transactions_df = transactions_df[transactions_df["customer_id"] == 4]

print(transactions_df["amount"])

def rise_count(vals, n=3):
    print(vals)
    count = 0
    length = len(vals)
    start = 0
    end = 1

    new_s = vals.shift(-1) - vals
    for _ in range(n):
        start_flag = length // n * start
        end_flag = length // n * end
        # print(start_flag, end_flag)
        piece = new_s.iloc[start_flag:end_flag]
        # print(sum(piece))
        # print()
        if (sum(piece) > 0):
            count += 1
        start += 1
        end += 1
    return count


if __name__ == '__main__':
    # s1 = pd.Series(list1)
    # print(rise_count(s1))
    # # 1
    #
    # s2 = pd.Series(list2)
    # print(rise_count(s2))
    # # 1
    #
    # s3 = pd.Series(list3)
    # print(rise_count(s3))
    # 1

    s4 = pd.Series(list4)
    print(rise_count(s4))
    print(sum(list4))
    # 2

    # s5 = pd.Series(list5)
    # print(rise_count(s5))
    # 2
